@page
@model Nexy.Pages.FeedModel
@{
Layout = "_Layout";
}

<div class="container">
    <div class="feed">
        <h2 class="feed__title">Лента</h2>
        <div id="post-container" class="space-y-4">
            <partial name="_FeedPostListPartial" model="Model.Posts" />
        </div>
        <button id="load-more" class="load-more pulse">Загрузить ещё</button>
    </div>
</div>

<script>
    let loaded = @Model.LoadedCount;

    document.getElementById("load-more").addEventListener("click", function () {
        fetch(`/Feed?handler=LoadMore&skip=${loaded}`)
            .then(response => response.text())
            .then(html => {
                const container = document.getElementById("post-container");
                const tempDiv = document.createElement("div");
                tempDiv.innerHTML = html;
                Array.from(tempDiv.children).forEach(child => {
                    child.classList.add("fade-in");
                    container.appendChild(child);
                });
                loaded += 10;
            });
    });
</script>